<!-- card , display all product-->
{% extends 'base.html' %}
<!-- load base-->
{% load humanize %}
<!-- load humanize-->
{% load static %}
<!-- block title-->
{% block title %} | Browser products {% endblock %}
<!--load static -->
{% block content %}
<!-- load query_transform -->
{% load query_transform %}

<style>
  .product-preview .card-body{
    min-height: 350px;
  }

  .description-text {
    height: 60px;     
    overflow-y: auto;   /* too more words > Scrollbar */
  }
  .btn-outline-primary {
  color: #ffb7b7ff;
  border-color: #ffb7b7ff;
}
.btn-outline-primary:hover, .active-cat {
  background-color: #ffb7b7ff !important;
  color: white !important;
  border-color: #ffb7b7ff !important;
}
#category-nav .btn {
  transition: all 0.3s ease;
  font-weight: 500;
}
</style>
    <section id="showcase-inner" class="py-5 text-white">
      <div class="container">
        <div class="row text-center">
          <div class="col-md-12">
            <h1 class="display-4">Welcome To Only K</h1>
            <p class="lead">
              Lorem ipsum dolor sit, amet consectetur adipisicing elit. Sunt,
              pariatur!
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Breadcrumb -->
    <section id="bc" class="mt-3">
      <div class="container">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              {% comment %} 去個home，所以pages，not products {% endcomment %}
              <a href={% url 'pages:index'%}><i class="fas fa-home"></i> Home</a>
            </li>
            <li class="breadcrumb-item active">Browse products</li>
          </ol>
        </nav>
      </div>
    </section>
    <!-- navigation-menu-top-layer -->
    <section class="mb-4" id="category-nav">
      <div class="container">
        <div class="d-flex justify-content-center flex-wrap">
          <a href="{% url 'products:index' %}" 
              class="btn m-1 {% if not current_category %}btn-dark{% else %} btn-outline-dark {% endif %}" 
              style="border-radius: 20px; padding: 5px 20px;">
              全部</a>
        {% for type in category_choices %}
        <!--  if 內 ==、!=、not 前後都要有space -->
          <a href="?category_type={{type}}" 
            class="btn m-1 {% if current_category == type %}btn-primary{% else %}btn-outline-primary{% endif %}" 
            style="border-radius: 20px; padding: 5px 20px; 
                {% if current_category == type %}background-color: #ffb7b7ff; border-color: #ffb7b7ff;{% else %}color: #ffb7b7ff; border-color: #ffb7b7ff;{% endif %}">
          {{type}}</a>
        {% endfor %}
        </div>
      </div>
    </section>
    <!-- products -->
    <section id="products" class="py-4">
      <div class="container"> 
      <!-- control pages -->
      <div id="product-container">
        {% include 'products/includes/partial_product_list.html' %}
      </div>    
      </div> 
    </section>
<script>
  function toggleDescription(productId){
    const dots = document.getElementById("dots-" + productId)
    const moreText = document.getElementById("more-" + productId)
    const btnText = document.getElementById("btn-" + productId)

    if(dots.style.display === "none"){
      dots.style.display = 'inline';
      btnText.innerHTML = "Back";
      moreText.style.display = "none"
    }else{
      dots.style.display = 'none';
      btnText.innerHTML = "Close";
      moreText.style.display = "inline"
    }
  }

  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('ajax-page-link')) {
        e.preventDefault(); 
        
        const url = e.target.getAttribute('href');
        
        document.getElementById('product-container').style.opacity = '0.5';

        fetch(url, {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('product-container').innerHTML = data.html;
            document.getElementById('product-container').style.opacity = '1';
            
            window.history.pushState({}, "", url);
            
            window.scrollTo({top: 0, behavior: 'smooth'});
        })
        .catch(error => console.error('Error:', error));
    }
});
</script>

{% endblock %}
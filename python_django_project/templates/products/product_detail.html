{% extends 'base.html' %}
<!---->
{% load humanize %}
<!---->
{% load static %}
<!---->
{% block title %} | {{ product.title | title }}
<!---->
{% endblock %}
<!---->
{% block content %}
<section
  id="showcase-inner"
  class="py-5 text-white"
  style="background-color: #174152ff"
>
  <div class="container">
    <div class="row text-center">
      <div class="col-md-12">
        <h1 class="display-4">{{ product.title | title }}</h1>
        <p class="lead">
          {% comment %} <i class="fas fa-map-marker"></i> {{ product.district |
          title }} {% endcomment %}
        </p>
      </div>
    </div>
  </div>
</section>

<section id="bc" class="mt-3">
  <div class="container">
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="{% url 'pages:index' %}">Home</a>
        </li>
        <li class="breadcrumb-item">
          <a href="{% url 'products:index' %}">Products</a>
        </li>
        <li class="breadcrumb-item active">{{ product.title | title }}</li>
      </ol>
    </nav>
  </div>
</section>

<section id="product" class="py-4">
  <div class="container">
    <a href="{% url 'products:index' %}" class="btn btn-light mb-4"
      >Back To Products</a
    >
    <div class="row">
      <div class="col-md-9">
        <img
          src="{{ product.image_00.url }}"
          alt=""
          class="img-main img-fluid mb-3"
          style="
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 10px;
          "
        />

        <!-- photo lists -->
        <div class="row mb-5 thumbs">
          {% for img in product_images %}
          <!---->
          {% if product.image_00 %}
          <div class="col-md-2 col-4 mb-2">
            <a href="{{ product.image_00.url }}" data-lightbox="home-images">
              <img
                src="{{ product.image_00.url }}"
                class="img-fluid border"
                style="height: 80px; width: 100%; object-fit: cover"
              />
            </a>
          </div>
          {% endif %}
          <!---->
          {% if product.image_01 %}
          <div class="col-md-2 col-4 mb-2">
            <a href="{{ product.image_01.url }}" data-lightbox="home-images"
              ><img
                src="{{ product.image_01.url }}"
                class="img-fluid border"
                style="height: 80px; width: 100%; object-fit: cover"
            /></a>
          </div>
          {% endif %}
          <!---->
          {% if product.image_02 %}
          <div class="col-md-2 col-4 mb-2">
            <a href="{{ product.image_02.url }}" data-lightbox="home-images"
              ><img
                src="{{ product.image_02.url }}"
                class="img-fluid border"
                style="height: 80px; width: 100%; object-fit: cover"
            /></a>
          </div>
          {% endif %}
          <!---->
          {% if product.image_03 %}
          <div class="col-md-2 col-4 mb-2">
            <a href="{{ product.image_03.url }}" data-lightbox="home-images"
              ><img
                src="{{ product.image_03.url }}"
                class="img-fluid border"
                style="height: 80px; width: 100%; object-fit: cover"
            /></a>
          </div>
          {% endif %}
          <!---->
          {% if product.image_04 %}
          <div class="col-md-2 col-4 mb-2">
            <a href="{{ product.image_04.url }}" data-lightbox="home-images"
              ><img
                src="{{ product.image_04.url }}"
                class="img-fluid border"
                style="height: 80px; width: 100%; object-fit: cover"
            /></a>
          </div>
          {% endif %}
          <!---->
          {% endfor %}
        </div>
        <!-- Product name -->
        <div class="card mb-5">
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <i class="fa-regular fa-heart text-secondary"></i>
              <b>Product Name : </b>
              <span class="float-right text-primary font-weight-bold"
                >{{ product.title | title }}</span
              >
            </li>
            <!-- Category -->
            <li class="list-group-item">
              <i class="fa-regular fa-heart text-secondary"></i>
              <b>Category : </b>
              <span class="float-right text-primary font-weight-bold"
                >{{ product.category.category_type | title }}</span
              >
            </li>
            <li class="list-group-item">
              <i class="fas fa-money-bill-alt text-success"></i> <b>Price : </b>
              <span class="float-right text-primary font-weight-bold"
                >${{ product.price | intcomma }}</span
              >
            </li>
            <!-- stock -->
            {% if product.category.category_type == "媽媽勾織"%}
            <!---->
            {% else %}
            <li class="list-group-item">
              <i class="fas fa-box text-secondary"></i> <b>Stock : </b>
              {% if product.category.category_type == "耳環" %}
              <span class="float-right"
                >Tailor-made items,Please contact Only K</span
              >
              {% else %}
              <span class="float-right">{{ product.stock_count }} items</span>
              {% endif %}
            </li>
            {% endif %}
            <!-- size -->
            <li class="list-group-item">
              <i class="fas fa-ruler-combined text-secondary"></i>
              <b>Size : </b>
              {% if product.category.category_type == "戒指" %}
              <span class="float-right">{{ product.size }}</span>
              {% elif product.category.category_type == "媽媽勾織" %}
              <span class="float-right"
                >Tailor-made items,Please contact Only K
              </span>
              {% else %}
              <span class="float-right">Not Applicable</span>
              {% endif %}
            </li>
          </ul>
        </div>

        <!-- -->
        {% comment %}
        <div class="row mb-4"></div>
        {% endcomment %}

        <!-- Description -->
        <div
          class="card card-body mb-5"
          style="background-color: #fbc6c6ff; border: none; color: #777474ff"
        >
          <h5 class="card-title" style="font-weight: bold">Description</h5>
          <hr />
          <div class="card-text">{{ product.description | linebreaks }}</div>
        </div>
      </div>

      <!-- inquiry , shopping cart-->
      <div class="col-md-3 custom-cart-btn">
        {% comment %}
        <div class="card shadow-sm mb-3">
          {% if product.image_00 %}
          <img
            class="card-img-top"
            src="{{ product.image_00.url }}"
            style="height: 200px; object-fit: cover"
          />
          {% endif %}
          <div class="card-body text-center">
            <h5 class="card-title">Practitioner</h5>
            <h6 class="text-secondary">{{ product.doctor.name }}</h6>
          </div>
        </div>
        {% endcomment %}
        <button
          class="btn btn-primary btn-block btn-lg"
          data-toggle="modal"
          data-target="#inquiryModal"
          style="
            background-color: #ffb7b7ff;
            border: none;
            font-size: 1.1rem !important;
          "
        >
          Make An Inquiry
        </button>
        {% comment %} {% url 'carts:cart_detail' %} {% endcomment %}
        <!---->
        {% if product.category.category_type in '戒指 頸鏈 耳環 手鏈' %}
        <button
          data-toggle="modal"
          data-target="#actualAddToCartModal"
          class="btn btn-primary btn-block btn-lg"
          style="
            background-color: #ffb7b7ff;
            border: none;
            font-size: 1.1rem !important;
            text-align:;
          "
        >
          Add To <br class="d-none d-md-block d-lg-none" />
          Shopping Cart
        </button>
        <!---->
        <div class="modal fade" id="actualAddToCartModal" role="dialog">
          <div class="modal-dialog">
            <div class="modal-content">
              <div
                class="modal-header text-white"
                style="background-color: #ffb7b7ff"
              >
                <h5 class="modal-title">Confirm Options : {{product.title}}</h5>
                <button
                  class="close text-white"
                  type="button"
                  data-dismiss="modal"
                >
                  <span>&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form
                  method="POST"
                  action="{% url 'carts:api_add_to_cart' product.id %}"
                >
                  {% csrf_token %}
                  <!---->
                  {% if product.category.category_type == '戒指' %}
                  <div class="form-group">
                    <label>Size Selection:</label>
                    <!-- Method : 1 -->
                    {% comment %}
                    <input
                      type="number"
                      min="11"
                      max="20"
                      class="form-control"
                      name="size"
                      placeholder="Please Input Size(11-20)"
                      required
                    />
                    {% endcomment %}
                    <!-- Method : 2 -->
                    {% comment %}
                    <select
                      name="size"
                      class="form-control"
                      required="required"
                    >
                      <option value="" disable="" selected="selected">
                        Please choose size: (11-20)
                      </option>
                      <option value="11">11</option>
                      <option value="12">12</option>
                      <option value="13">13</option>
                      <option value="14">14</option>
                      <option value="15">15</option>
                      <option value="16">16</option>
                      <option value="17">17</option>
                      <option value="18">18</option>
                      <option value="19">19</option>
                      <option value="20">20</option>
                    </select>
                    {% endcomment %}
                    <!-- Method : 3-->
                    <select
                      name="size"
                      id=""
                      class="form-control"
                      required="required"
                    >
                      {% for i in "123456789" %}
                      <option value="{{forloop.counter|add:10}}" class="">
                        {{forloop.counter|add:10}}
                      </option>
                      {% endfor %}
                    </select>
                  </div>
                  {% else %}
                  <div class="text-center py-3">
                    <span class="font-weight-bold"
                      >Thank you for shopping
                    </span>
                  </div>
                  <input type="hidden" name="size" value="Standard" />
                  <!---->
                  {% endif %}
                  <div class="text-center mt-3">
                    <button
                      class="btn btn-primary"
                      type="submit"
                      style="background-color: #ffb7b7ff; color: #fff"
                      onClick="console.log('Form is being submitted!')"
                    >
                      Confirm & Add
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        {% endif %}
      </div>
      <!-- shopping cart-->
    </div>
  </div>
</section>

<!-- message modal -->
<div class="modal fade" id="inquiryModal" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header text-white" style="background-color: #ffb7b7ff">
        <h5 class="modal-title">Contact Only K</h5>
        <button type="button" class="close text-white" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- modify url -->
        <form method="POST" action="{% url 'products:search' %}">
          {% csrf_token %}
          <input type="hidden" name="listing_id" value="{{ product.id }}" />
          <input
            type="hidden"
            name="doctor_email"
            value="{{ product.doctor.email }}"
          />

          {% if user.is_authenticated %}
          <input type="hidden" name="user_id" value="{{ user.id }}" />
          {% else %}
          <input type="hidden" name="user_id" value="0" />
          {% endif %}

          <div class="form-group">
            <label>Accessories :</label>
            <input
              type="text"
              name="product"
              class="form-control"
              value="{{ product.title }}"
              readonly
            />
          </div>
          {% if user.is_authenticated %}
          <div class="form-group">
            <label>Name:</label>
            <input
              type="text"
              name="name"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              value="{{ user.get_full_name }}"
              readonly
              {%
              endif
              %}
              required
            />
          </div>
          <div class="form-group">
            <label>Email:</label>
            <input
              type="email"
              name="email"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              value="{{ user.email }}"
              readonly
              {%
              endif
              %}
              required
            />
          </div>
          {% else %}
          <div class="form-group">
            <label>Name:</label>
            <input
              type="text"
              name="name"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              placeholder="Input your name"
              {%
              endif
              %}
              required
            />
          </div>
          <div class="form-group">
            <label>Email:</label>
            <input
              type="email"
              name="email"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              placeholder="Input your email"
              {%
              endif
              %}
              required
            />
          </div>

          {% endif %}
          <div class="form-group">
            <label>Phone:</label>
            <input
              type="text"
              name="phone"
              class="form-control"
              placeholder="Input your phone number"
              required
            />
          </div>
          <div class="form-group">
            <label>Message:</label>
            <textarea name="message" class="form-control" rows="3"></textarea>
          </div>
          <input
            type="submit"
            value="Send Message"
            class="btn btn-block"
            style="
              color: #fff;
              background-color: #ffb7b7ff !important;
              border: none !important;
              outline: none !important;
            "
          />
        </form>
      </div>
    </div>
  </div>
</div>
<!-- shopping cart modal -->
<div class="modal fade shoppingCartLeft" id="shoppingCartLeft" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header text-white" style="background-color: #ffb7b7ff">
        <h5 class="modal-title">{{product.title | title}}</h5>
        <button type="button" class="close text-white" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- need to modify url -->
        <form method="POST" action="{% url 'products:search' %}">
          {% csrf_token %} {% comment %}
          <input type="hidden" name="listing_id" value="{{ product.id }}" />
          <input
            type="hidden"
            name="doctor_email"
            value="{{ product.doctor.email }}"
          />
          {% endcomment %} {% if user.is_authenticated %}
          <input type="hidden" name="user_id" value="{{ user.id }}" />
          {% else %}
          <input type="hidden" name="user_id" value="0" />
          {% endif %}

          <div class="form-group">
            <label>Product Name :</label>
            <input
              type="text"
              name="product"
              class="form-control"
              value="{{ product.title }}"
              readonly
            />
          </div>
          <div class="form-group">
            <label>Category : </label>
            <input
              type="text"
              name="category"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              value="{{ product.category.category_type }}"
              readonly
              {%
              endif
              %}
              required
            />
          </div>
          <div class="form-group">
            <label>Price:</label>
            <input
              type="text"
              name="price"
              class="form-control"
              {%
              if
              user.is_authenticated
              %}
              value="{{ product.price }}"
              readonly
              {%
              endif
              %}
              required
            />
          </div>
          <div class="form-group">
            <label>Size :</label>
            {% if product.category.category_type == '戒指' %}
            <input
              type="text"
              name="size"
              class="form-control"
              placeholder="請輸入尺寸"
              required
            />
            {% elif product.category.category_type == '媽媽勾織'%}
            <input
              type="text"
              name="size"
              class="form-control"
              value="請聯絡Only K for Tailor-made"
              readonly
            />
            {% else %}
            <input type="text" class="form-control" value="不適用" readonly />
            <input type="hidden" name="size" value="0" />
            {% endif %}
          </div>
          <input
            style="background-color: #ffb7b7ff; color: #fff"
            type="submit"
            value="Add To Shopping Cart"
            class="btn btn-block"
          />
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% extends 'base.html' %}
<!---->
{% load static %}
<!---->
{% block title %} | Reset Password Confirm{% endblock %}
<!---->
{% block content %}
<div class="row py-5">
  <div
    class="col-md-6 mx-auto shadow-sm p-5 my-5"
    style="background: #fff; border-radius: 10px; max-width: 500px"
  >
    {% if validlink %}
    <h3 class="text-center mb-4">設定新密碼</h3>
    <p class="text-muted text-center small">請輸入並確認您的新密碼。</p>

    <form method="POST">
      {% csrf_token %}
      <!---->
      {% if form.non_field_errors %} {% for error in form.non_field_errors %}
      <div class="alert alert-danger">{{ error }}</div>
      {% endfor %}
      <!---->
      {% endif %}

      <div class="password-form-wrapper">
        {% for field in form %}
        <div class="form-group mb-3">
          <label class="font-weight-bold">{{ field.label }}</label>

          {{ field }}
          <!---->
          {% if field.errors %}
          <!---->
          {% for error in field.errors %}
          <div class="text-danger small">{{ error }}</div>
          <!---->
          {% endfor %}
          <!---->
          {% endif %}
          <!---->
          {% if field.help_text %}
          <small class="form-text text-muted">{{ field.help_text|safe }}</small>
          {% endif %}
        </div>
        {% endfor %}
      </div>

      <button
        type="submit"
        class="btn btn-primary w-100 mt-4"
        style="
          background-color: #ff8e8eff;
          border: none;
          padding: 12px;
          font-weight: bold;
          border-radius: 8px;
        "
      >
        確認修改並儲存
      </button>
    </form>

    {% else %}
    <div class="text-center">
      <h3 class="text-danger">連結已失效</h3>
      <p>重設密碼的連結可能已過期，或已被使用過。</p>
      <a
        href="{% url 'users:password_reset' %}"
        class="btn btn-outline-primary mt-3"
      >
        重新請求重設密碼
      </a>
    </div>
    {% endif %}
  </div>
</div>

<style>
  .password-form-wrapper input {
    display: block;
    width: 100%;
    padding: 12px;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    margin-top: 5px;
    background-color: #f8f9fa;
  }
  .password-form-wrapper input:focus {
    border-color: #ff8e8eff;
    outline: none;
    background-color: #fff;
    box-shadow: 0 0 0 0.2rem rgba(255, 142, 142, 0.25);
  }
  .password-form-wrapper ul {
    list-style: none;
    padding-left: 0;
    font-size: 0.8rem;
    color: #6c757d;
    margin-top: 5px;
  }
</style>
{% endblock %}
